결과 파일: C:\Users\USER\Desktop\autotrade\test_results\websocket_test_20251101_160215.txt

⚠️  주의: WebSocket 테스트는 장 시작 시간(9:00-15:30)에만 작동합니다
⚠️  장 외 시간에는 실시간 데이터가 수신되지 않을 수 있습니다

테스트를 시작하시겠습니까? (y/n): ================================================================================
WebSocket 구독 기능 테스트
================================================================================
시작 시간: 2025-11-01 16:02:17

WebSocket 연결 중...
URL: wss://api.kiwoom.com:10000/api/dostk/websocket
✅ WebSocket 연결 성공

실시간 가격 구독: 005930

실시간 호가 구독: 005930

실시간 지수 구독: 0001

실시간 데이터 수신 중... (30초)
--------------------------------------------------------------------------------
[1] 16:02:19 - Unknown
  Data: {}...
[2] 16:02:19 - Unknown
  Data: {}...
[3] 16:02:19 - Unknown
  Data: {}...
[4] 16:02:29 - Unknown
  Data: {}...
❌ 수신 오류: received 1000 (OK) Bye; then sent 1000 (OK) Bye
--------------------------------------------------------------------------------
총 4개 메시지 수신

구독 해제: H0STCNT0 - 005930
Traceback (most recent call last):
  File "C:\Users\USER\Desktop\autotrade\test_websocket.py", line 306, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\USER\Desktop\autotrade\test_websocket.py", line 279, in main
    await tester.run_test()
  File "C:\Users\USER\Desktop\autotrade\test_websocket.py", line 269, in run_test
    await self.disconnect()
  File "C:\Users\USER\Desktop\autotrade\test_websocket.py", line 230, in disconnect
    await self.unsubscribe(tr_id, tr_key)
  File "C:\Users\USER\Desktop\autotrade\test_websocket.py", line 174, in unsubscribe
    await self.ws.send(json.dumps(message))
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
               ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\AppData\Local\Programs\Python\Python313\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1000 (OK) Bye; then sent 1000 (OK) Bye

C:\Users\USER\Desktop\autotrade>
